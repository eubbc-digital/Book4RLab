<app-navbar></app-navbar>

<div class="page-content lab-container">
  <div class="header">
    <div class="text-center">
      <h4>
        Search for a laboratory by <span class="search-keyword">name</span>, <span class="search-keyword">country</span>,
        <span class="search-keyword">university</span>, <span class="search-keyword">instructor</span>,
        or <span class="search-keyword">course</span>, and select an available time slot to make a reservation.
      </h4>

      <mat-form-field class="searched-lab-field" appearance="fill">
        <mat-label>Search laboratories</mat-label>
        <input matInput type="text" [(ngModel)]="searchedLab" placeholder="Search by name, country, university, instructor, or course" />
        <mat-icon matPrefix id="search-icon">search</mat-icon>
        <button *ngIf="searchedLab" matSuffix mat-icon-button aria-label="Clear" (click)="searchedLab = ''">
          <mat-icon>close</mat-icon>
        </button>
      </mat-form-field>
    </div>
  </div>

  <div class="row">
    <div *ngFor="let lab of labs | filter : searchedLab" class="cols-5 card-container">
      <mat-card class="card card-hghlght">
        <mat-card-header class="card-header">
          <div class="laboratory-type-header">
            <div *ngIf="lab.type=='rt'">
              <span class="rt">Real Time</span>
            </div>
            <div *ngIf="lab.type=='uc'">
              <span class="uc">Ultra Concurrent</span>
            </div>
          </div>
          <mat-card-title>{{ lab.name }}</mat-card-title>
          <mat-card-subtitle>{{ lab.university }}</mat-card-subtitle>
        </mat-card-header>

        <img mat-card-image [src]="lab.image ?? defaultLabImg" alt="Remote lab" class="remote-lab-img" />

        <mat-card-content class="card-content">
          <p>
            <strong>Course: </strong> {{ lab.course }}
            <br />
            <strong>Instructor: </strong> {{ lab.instructor }}
            <br />
            <strong>Description:</strong>
            {{ lab.description }}
          </p>
        </mat-card-content>
        <mat-card-actions class="card-actions">
          <div class="availability-info">
            <div class="availability-status"
                [class.available]="lab.is_available_now || lab.type === 'uc'"
                [class.not-available]="!lab.is_available_now && lab.type !== 'uc'"
                [matTooltip]="getAvailabilityTooltip(lab)">
              <span>
                {{ (lab.is_available_now || lab.type === 'uc') ? 'AVAILABLE' : 'NOT AVAILABLE' }}
                <span *ngIf="lab.type === 'uc'" class="uc-badge">(UC)</span>
              </span>
            </div>
          </div>
          <button mat-stroked-button
                  color="primary"
                  class="info-button"
                  (click)="moreInfoLab(lab)">
            VIEW DETAILS
          </button>
        </mat-card-actions>
      </mat-card>
    </div>
  </div>
</div>

<app-scroll-to-top></app-scroll-to-top>
